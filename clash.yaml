mixed-port: 7893
tcp-concurrent: true
allow-lan: true
ipv6: true
log-level: debug
find-process-mode: strict
unified-delay: false

external-controller: 0.0.0.0:9093
secret: '123456'
external-ui: ui
external-ui-name: ss1
external-ui-url: "https://ghproxy.cn/https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip"

# Tun é…ç½®
tun:
  enable: false
  stack: mixed
  dns-hijack:
    - "any:53"
    - "tcp://any:53"
  auto-route: true
  auto-redirect: true
  auto-detect-interface: true

profile:
  store-selected: true 
  store-fake-ip: true  
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]

geodata-mode: true
geox-url:
  geoip: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
  geosite: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
  mmdb: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.metadb"

geo-auto-update: false # æ˜¯å¦è‡ªåŠ¨æ›´æ–° geodata
geo-update-interval: 24 # æ›´æ–°é—´éš”ï¼Œå•ä½ï¼šå°æ—¶
dns:
  enable: true
  listen: '127.0.0.1:8853'
  prefer-h3: true
  cache-algorithm: arc
  default-nameserver:
    - system
    - tls://1.12.12.12:853
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-filter:
    - '*.lan'
    - '*.localdomain'
    - '*.example'
    - '*.invalid'
    - '*.localhost'
    - '*.test'
    - '*.local'
    - '*.home.arpa'
    - 'time.*.com'
    - 'time.*.gov'
    - 'time.*.edu.cn'
    - 'time.*.apple.com'
    - 'time1.*.com'
    - 'time2.*.com'
    - 'time3.*.com'
    - 'time4.*.com'
    - 'time5.*.com'
    - 'time6.*.com'
    - 'time7.*.com'
    - 'ntp.*.com'
    - 'ntp1.*.com'
    - 'ntp2.*.com'
    - 'ntp3.*.com'
    - 'ntp4.*.com'
    - 'ntp5.*.com'
    - 'ntp6.*.com'
    - 'ntp7.*.com'
    - '*.time.edu.cn'
    - '*.ntp.org.cn'
    - '+.pool.ntp.org'
    - 'time1.cloud.tencent.com'
    - 'music.163.com'
    - '*.music.163.com'
    - '*.126.net'
    - 'musicapi.taihe.com'
    - 'music.taihe.com'
    - 'songsearch.kugou.com'
    - 'trackercdn.kugou.com'
    - '*.kuwo.cn'
    - 'api-jooxtt.sanook.com'
    - 'api.joox.com'
    - 'joox.com'
    - 'y.qq.com'
    - '*.y.qq.com'
    - 'streamoc.music.tc.qq.com'
    - 'mobileoc.music.tc.qq.com'
    - 'isure.stream.qqmusic.qq.com'
    - 'dl.stream.qqmusic.qq.com'
    - 'aqqmusic.tc.qq.com'
    - 'amobile.music.tc.qq.com'
    - '*.xiami.com'
    - '*.music.migu.cn'
    - 'music.migu.cn'
    - '+.msftconnecttest.com'
    - '+.msftncsi.com'
    - 'msftconnecttest.com'
    - 'msftncsi.com'
    - 'localhost.ptlogin2.qq.com'
    - 'localhost.sec.qq.com'
    - '+.srv.nintendo.net'
    - '+.stun.playstation.net'
    - 'xbox.*.microsoft.com'
    - 'xnotify.xboxlive.com'
    - '+.ipv6.microsoft.com'
    - '+.battlenet.com.cn'
    - '+.wotgame.cn'
    - '+.wggames.cn'
    - '+.wowsgame.cn'
    - '+.wargaming.net'
    - 'proxy.golang.org'
    - 'stun.*.*'
    - 'stun.*.*.*'
    - '+.stun.*.*'
    - '+.stun.*.*.*'
    - '+.stun.*.*.*.*'
    - 'heartbeat.belkin.com'
    - '*.linksys.com'
    - '*.linksyssmartwifi.com'
    - '*.router.asus.com'
    - 'mesu.apple.com'
    - 'swscan.apple.com'
    - 'swquery.apple.com'
    - 'swdownload.apple.com'
    - 'swcdn.apple.com'
    - 'swdist.apple.com'
    - 'lens.l.google.com'
    - 'stun.l.google.com'
    - '*.square-enix.com'
    - '*.finalfantasyxiv.com'
    - '*.ffxiv.com'
    - '*.ff14.sdo.com'
    - 'ff.dorado.sdo.com'
    - '*.mcdn.bilivideo.cn'
    - '+.media.dssott.com'
    - '+.pvp.net'
  nameserver:
    - 'https://223.5.5.5/dns-query#h3=true'
    - 'https://1.1.1.1/dns-query#h3=true'
  fallback:
    - 'https://dns.google/dns-query'
  fallback-filter:
    geoip: false
    ipcidr:
      - 240.0.0.0/4
      - 0.0.0.0/32
      - 127.0.0.1/32
    domain:
      - '+.facebook.com'
      - '+.twitter.com'
      - '+.google.com'
      - '+.googleapis.com'
      - '+.google.cn'
      - '+.googleapis.cn'
      - '+.xn--ngstr-lra8j.com'
      - '+.googlevideo.com'
      - '+.gvt1.com'
      - '+.gmail.com'
      - '+.youtube.com'
      - '+.youtu.be'
      - '+.gvt0.com'
      - '+.gvt2.com'
      - '+.gvt3.com'
      - '+.gstatic.com'
      - '+.265.com'
      - '+.2mdn.net'
      - '+.app-measurement.com'
      - '+.c.admob.com'
      - '+.clickserve.dartsearch.net'
      - '+.crl.pki.goog'
      - '+.doubleclick.net'
      - '+.firebase-settings.crashlytics.com'
      - '+.google-analytics.com'
      - '+.googleadservices.com'
      - '+.googleanalytics.com'
      - '+.googleoptimize.com'
      - '+.googlesyndication.com'
      - '+.googletagmanager.com'
      - '+.googletagservices.com'
#  nameserver-policy:
#   'geosite:private,apple-cn,apple@cn,cn':
#       - 114.114.114.114
#   'geosite:geolocation-!cn':
#       - 'https://8.8.8.8/dns-query#PROXY'
#subscribe-url: >-
#  https://ELNpHZa.doggygo.top:8443/api/v1/client/aa4bcd3d285154c06d75f73ed4ad78fd

proxy-groups:
  - name: æ‰‹åŠ¨åˆ‡æ¢
    icon: 'https://github.com/shindgewongxj/WHATSINStash/raw/main/icon/%24tash.png'
    type: select
    include-all: null
    proxies:
      - DIRECT
      - é¦™æ¸¯èŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
    use:
      - sub0
  - name: æµé‡æ— é™
    type: url-test
    url: 'http://www.gstatic.com/generate_204'
    use:
      - sub2
    interval: 270
    filter: ^(?!.*(?:é¦™æ¸¯é›†ç¾¤|é¦™æ¸¯-ä¸“çº¿)).+$
    proxies:
      - ub1
      - ub2
      - ub0
    lazy: true
  - name: ç¾Žå›½èŠ‚ç‚¹
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png
    type: url-test
    url: 'http://1.1.1.1/generate_204'
    interval: 300
    include-all: null
    filter: "(?i)ðŸ‡ºðŸ‡¸|ç¾Žå›½|æ´›æ‰çŸ¶|åœ£ä½•å¡ž|(\b(US|United States)\b)"
    use:
      - sub1
      - sub0
  - name: ç‹®åŸŽèŠ‚ç‚¹
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png
    type: url-test
    url: 'http://1.1.1.1/generate_204'
    interval: 300
    include-all: null
    filter: "(?i)ðŸ‡¸ðŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|Singapore)\b)"
    use:
      - sub1
      - sub0
  - name: é¦™æ¸¯èŠ‚ç‚¹
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png
    type: url-test
    url: 'http://1.1.1.1/generate_204'
    interval: 300
    include-all: null
    use:
      - sub1
      - sub0
    filter: "(?i)ðŸ‡­ðŸ‡°|é¦™æ¸¯|(\b(HK|Hong)\b)"
    lazy: true
    timeout: 1000
  - name: æ—¥æœ¬èŠ‚ç‚¹
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png
    type: url-test
    url: 'http://1.1.1.1/generate_204'
    interval: 300
    include-all: null
    filter: "(?i)ðŸ‡¯ðŸ‡µ|æ—¥æœ¬|ä¸œäº¬|(\b(JP|Japan)\b)"
    use:
      - sub1
      - sub0
  - name: å°æ¹¾èŠ‚ç‚¹
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/China.png
    type: url-test
    url: 'http://1.1.1.1/generate_204'
    interval: 300
    filter: "(?i)ðŸ‡¨ðŸ‡³|ðŸ‡¹ðŸ‡¼|å°æ¹¾|(\b(TW|Tai|Taiwan)\b)"
    use:
      - sub1
      - sub0
  - include-all: null
    name: è‡ªåŠ¨
    proxies:
      - æµé‡æ— é™
      - æ—¥æœ¬èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
    type: select
    url: 'http://1.1.1.1/generate_204'
    interval: 300
    lazy: true
    timeout: 1000
  - name: tiktok
    proxies:
      - ç‹®åŸŽèŠ‚ç‚¹
      - æµé‡æ— é™
      - DIRECT
      - å°æ¹¾èŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
    type: select
  - name: æ²¹ç®¡
    proxies:
      - ç‹®åŸŽèŠ‚ç‚¹
      - DIRECT
      - æµé‡æ— é™
      - æ—¥æœ¬èŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - é¦™æ¸¯èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
    type: select
  - name: å…œåº•åˆ†æµ
    icon: 'https://github.com/shindgewongxj/WHATSINStash/raw/main/icon/friestash.png'
    type: select
    proxies:
      - DIRECT
      - ç¾Žå›½èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - æµé‡æ— é™
      - æ‰‹åŠ¨åˆ‡æ¢
      - è‡ªåŠ¨
  - name: å›½é™…åª’ä½“
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png
    type: select
    proxies:
      - DIRECT
      - æ‰‹åŠ¨åˆ‡æ¢
      - é¦™æ¸¯èŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
    include-all: null
  - name: å¾®è½¯æœåŠ¡
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Microsoft.png
    type: select
    proxies:
      - DIRECT
      - æ‰‹åŠ¨åˆ‡æ¢
      - é¦™æ¸¯èŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
  - name: è°·æ­ŒæœåŠ¡
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Google_Search.png
    type: select
    proxies:
      - ç¾Žå›½èŠ‚ç‚¹
      - æµé‡æ— é™
      - é¦™æ¸¯èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
  - name: bing
    proxies:
      - DIRECT
      - æµé‡æ— é™
      - æ—¥æœ¬èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - é¦™æ¸¯èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
    type: select
  - name: ç”µæŠ¥æ¶ˆæ¯
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram.png
    type: select
    proxies:
      - æ—¥æœ¬èŠ‚ç‚¹
      - æµé‡æ— é™
      - é¦™æ¸¯èŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
      - æ‰‹åŠ¨åˆ‡æ¢
  - name: æŽ¨ç‰¹æ¶ˆæ¯
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Twitter.png
    type: select
    proxies:
      - ç¾Žå›½èŠ‚ç‚¹
      - æ‰‹åŠ¨åˆ‡æ¢
      - é¦™æ¸¯èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
      - DIRECT
  - name: è‹¹æžœ
    proxies:
      - DIRECT
      - å°æ¹¾èŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - é¦™æ¸¯èŠ‚ç‚¹
    type: select
  - name: AI
    icon: 'https://raw.githubusercontent.com/Orz-3/mini/master/Color/OpenAI.png'
    type: select
    proxies:
      - æ—¥æœ¬èŠ‚ç‚¹
      - æ‰‹åŠ¨åˆ‡æ¢
      - æµé‡æ— é™
      - é¦™æ¸¯èŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
  - name: æ¸¸æˆå¹³å°
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Game.png
    type: select
    proxies:
      - DIRECT
      - æ‰‹åŠ¨åˆ‡æ¢
      - é¦™æ¸¯èŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
  - name: Emby
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Emby.png
    type: select
    include-all: null
    proxies:
      - DIRECT
      - é¦™æ¸¯èŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
  - name: Spotify
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Spotify.png
    type: select
    proxies:
      - DIRECT
      - æ‰‹åŠ¨åˆ‡æ¢
      - é¦™æ¸¯èŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
  - name: å›½å¤–ç½‘ç«™
    icon: >-
      https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Global.png
    type: select
    proxies:
      - ç‹®åŸŽèŠ‚ç‚¹
      - æµé‡æ— é™
      - DIRECT
      - æ‰‹åŠ¨åˆ‡æ¢
      - é¦™æ¸¯èŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - å°æ¹¾èŠ‚ç‚¹
  - name: å›½å†…ç½‘ç«™
    proxies:
      - DIRECT
      - å°æ¹¾èŠ‚ç‚¹
      - æ—¥æœ¬èŠ‚ç‚¹
      - ç‹®åŸŽèŠ‚ç‚¹
      - ç¾Žå›½èŠ‚ç‚¹
      - é¦™æ¸¯èŠ‚ç‚¹
      - è‡ªåŠ¨
    type: select
  - name: å¹¿å‘Š
    proxies:
      - DIRECT
      - æ‰‹åŠ¨åˆ‡æ¢
      - REJECT
    type: select

  - name: ub0
    type: select
    proxies:
      - REJECT
    use:
      - sub0
  - name: ub1
    type: select
    proxies:
      - REJECT
    use:
      - sub1
  - name: ub2
    type: select
    proxies:
      - REJECT
    use:
      - sub2

rule-providers:
  # å±€åŸŸç½‘
  Lan: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Lan.list, type: http}

  # å¹¿å‘Šæ‹¦æˆª
  Reject: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Reject.list, type: http}

  # è‹¹æžœæœåŠ¡
  Apple: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Apple.list, type: http}
  AppleProxy: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/AppleProxy.list, type: http}
  
  # å¾®è½¯æœåŠ¡
  Microsoft: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Microsoft.list, type: http}
  OneDrive: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/OneDrive.list, type: http}
  Github: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Github.list, type: http}

  # è°·æ­ŒæœåŠ¡
  Youtube: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/YouTube.list, type: http}
  Google: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Google.list, type: http}

  # ç”µæŠ¥æ¶ˆæ¯
  Telegram: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Telegram.list, type: http}

  # æŽ¨ç‰¹æ¶ˆæ¯
  Twitter: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Twitter.list, type: http}

  # æ¸¸æˆå¹³å°
  Steam: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Steam.list, type: http}
  Epic: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Epic.list, type: http}

  # AIå¹³å°
  AI: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/AI.list, type: http}

  # Emby
  Emby: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Emby.list, type: http}

  # Spotify
  Spotify: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Spotify.list, type: http}
  
  # å›½é™…åª’ä½“
  Bahamut: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Bahamut.list, type: http}
  Netflix: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Netflix.list, type: http}
  Disney: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/Disney.list, type: http}
  PrimeVideo: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/PrimeVideo.list, type: http}
  HBO: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/HBO.list, type: http}
  TikTok: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/TikTok.list, type: http}

  # ä»£ç†ç½‘ç«™
  ProxyGFW: {behavior: classical, format: text, interval: 86400, url: https://github.com/Repcz/Tool/raw/X/Stash/Rules/ProxyGFW.list, type: http}

  å›½å†…:
    type: http
    behavior: classical
    interval: 86400
    url: >-
      https://ghproxy.cn/https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/refs/heads/master/Clash/ChinaDomain.list
    format: text
  bing:
    type: http
    behavior: classical
    format: text
    interval: 86400
    url: >-
      https://ghproxy.cn/https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/refs/heads/master/Clash/Bing.list
rules:
  - DOMAIN-KEYWORD,openwrt,è‡ªåŠ¨
  - DOMAIN-KEYWORD,tiktokcdn,è‡ªåŠ¨
  - DOMAIN-SUFFIX,googlevideo.com,è‡ªåŠ¨
